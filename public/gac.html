<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>GDMS ‚Äî Gift Administration Committee</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css" rel="stylesheet">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üéÅ</text></svg>">
  <style>
    :root {
      --gdms-blue: #1a5f7a;
      --gdms-teal: #159895;
      --gdms-accent: #57c5b6;
      --gdms-gold: #d97706;
      --gdms-purple: #6610f2;
      --gdms-green: #059669;
      --gdms-red: #dc2626;
    }
    /* Loading Screen */
    #loading-screen {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background: linear-gradient(135deg, var(--gdms-purple), var(--gdms-blue));
      display: flex; flex-direction: column; justify-content: center;
      align-items: center; z-index: 9999; transition: opacity 0.5s ease;
    }
    .loading-spinner {
      width: 60px; height: 60px; border: 5px solid rgba(255,255,255,0.3);
      border-radius: 50%; border-top-color: white; animation: spin 1s ease-in-out infinite;
      margin-bottom: 20px;
    }
    @keyframes spin { to { transform: rotate(360deg); } }
    .loading-text { color: white; font-size: 1.2rem; margin-top: 10px; }
    /* Role Badge */
    .role-badge {
      display: inline-block; padding: 3px 8px; border-radius: 12px;
      font-size: 0.75rem; font-weight: 600; margin-left: 8px;
    }
    .role-gac-member { background: #6610f2; color: white; }
    /* Agency Badge */
    .agency-badge {
      display: inline-block; padding: 2px 8px;
      background: #f3f4f6; color: var(--gdms-blue);
      border-radius: 10px; font-size: 0.75rem; font-weight: 500;
      margin-left: 5px;
    }
    /* Stat Card */
    .stat-card {
      background: white; border-radius: 12px; padding: 1.25rem;
      box-shadow: 0 2px 6px rgba(0,0,0,0.05); transition: all 0.2s;
    }
    .stat-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    /* Action Button */
    .action-btn {
      display: flex; flex-direction: column; align-items: center;
      justify-content: center; padding: 1rem; 
      background: linear-gradient(135deg, var(--gdms-purple), var(--gdms-blue));
      color: white; border: none; border-radius: 10px;
      font-size: 0.9rem; font-weight: 600; cursor: pointer; transition: all 0.3s;
    }
    .action-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 12px rgba(102, 16, 242, 0.2);
    }
    .action-btn i { font-size: 1.5rem; margin-bottom: 0.5rem; }
    /* Status Badge */
    .status-badge {
      padding: 4px 10px; border-radius: 20px; font-size: 0.8rem; font-weight: 500;
    }
    .status-pending { background: #fff3cd; color: #856404; }
    .status-approved { background: #d4edda; color: #155724; }
    .status-returned { background: #f8d7da; color: #721c24; }
    .status-active { background: #d4edda; color: #155724; }
    .status-waiting { background: #cce5ff; color: #004085; }
    .status-forwarded { background: #e8f4fd; color: #0d6efd; }
    /* Connection Status */
    #connection-status {
      position: fixed; bottom: 10px; right: 10px; padding: 8px 15px;
      border-radius: 20px; font-size: 0.8rem; z-index: 1000;
      background: #d4edda; color: #155724; border: 1px solid #c3e6cb;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      display: flex; align-items: center; gap: 8px;
    }
    /* Modal Styles */
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      z-index: 1000;
      justify-content: center;
      align-items: center;
      padding: 20px;
    }
    .modal.active {
      display: flex;
    }
    .modal-content {
      background-color: white;
      border-radius: 10px;
      width: 100%;
      max-width: 800px;
      max-height: 90vh;
      overflow-y: auto;
      animation: modalFadeIn 0.3s ease;
    }
    @keyframes modalFadeIn {
      from { opacity: 0; transform: translateY(-20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .modal-header {
      padding: 20px;
      border-bottom: 1px solid #dee2e6;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .modal-header h3 {
      color: var(--gdms-purple);
      margin: 0;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .modal-close {
      background: none;
      border: none;
      font-size: 1.5rem;
      cursor: pointer;
      color: #6c757d;
    }
    .modal-body {
      padding: 20px;
    }
    .modal-footer {
      padding: 20px;
      border-top: 1px solid #dee2e6;
      display: flex;
      justify-content: flex-end;
      gap: 10px;
    }
    /* Form Styles */
    .form-group {
      margin-bottom: 20px;
    }
    .form-label {
      display: block;
      margin-bottom: 8px;
      font-weight: 500;
      color: #333;
    }
    .form-control {
      width: 100%;
      padding: 10px 12px;
      border: 1px solid #ddd;
      border-radius: 6px;
      font-size: 1rem;
      transition: border-color 0.3s;
    }
    .form-control:focus {
      outline: none;
      border-color: var(--gdms-purple);
      box-shadow: 0 0 0 3px rgba(102, 16, 242, 0.1);
    }
    .form-row {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 15px;
    }
    /* Table Styles */
    .table-container {
      overflow-x: auto;
    }
    .table {
      width: 100%;
      border-collapse: collapse;
      min-width: 600px;
    }
    .table th {
      background-color: #f8f9fa;
      padding: 12px 15px;
      text-align: left;
      font-weight: 600;
      color: #333;
      border-bottom: 1px solid #dee2e6;
      white-space: nowrap;
    }
    .table td {
      padding: 12px 15px;
      border-bottom: 1px solid #eee;
    }
    .table tr:hover {
      background-color: #f8f9fa;
    }
    /* Button Styles */
    .btn {
      padding: 8px 16px;
      border: none;
      border-radius: 6px;
      font-size: 0.9rem;
      font-weight: 500;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      transition: all 0.3s;
    }
    .btn-primary {
      background: var(--gdms-purple);
      color: white;
    }
    .btn-primary:hover {
      background: #5a13dd;
    }
    .btn-secondary {
      background: #6c757d;
      color: white;
    }
    .btn-secondary:hover {
      background: #545b62;
    }
    .btn-success {
      background: #28a745;
      color: white;
    }
    .btn-success:hover {
      background: #1e7e34;
    }
    .btn-danger {
      background: #dc3545;
      color: white;
    }
    .btn-danger:hover {
      background: #bd2130;
    }
    .btn-sm {
      padding: 6px 12px;
      font-size: 0.8rem;
    }
    /* Page Transitions */
    .page {
      display: none;
      animation: fadeIn 0.5s ease;
    }
    .page.active {
      display: block;
    }
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    /* Alert Styles */
    .alert {
      padding: 12px 16px;
      border-radius: 6px;
      margin-bottom: 20px;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .alert-success {
      background-color: #d4edda;
      color: #155724;
      border-left: 4px solid #c3e6cb;
    }
    .alert-warning {
      background-color: #fff3cd;
      color: #856404;
      border-left: 4px solid #ffeaa7;
    }
    .alert-error {
      background-color: #f8d7da;
      color: #721c24;
      border-left: 4px solid #f5c6cb;
    }
    .alert-info {
      background-color: #d1ecf1;
      color: #0c5460;
      border-left: 4px solid #bee5eb;
    }
    /* File Upload Styles */
    .file-upload-container {
      border: 2px dashed #ddd;
      border-radius: 8px;
      padding: 30px;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s;
      background: #f8f9fa;
    }
    .file-upload-container:hover {
      border-color: var(--gdms-purple);
      background: #f5f3ff;
    }
    .file-upload-container.dragover {
      border-color: var(--gdms-purple);
      background: #e9d5ff;
      transform: scale(1.02);
    }
    .file-preview {
      margin-top: 15px;
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
    }
    .file-preview-item {
      position: relative;
      width: 100px;
      height: 100px;
      border-radius: 6px;
      overflow: hidden;
      border: 1px solid #ddd;
    }
    .file-preview-item img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    .file-preview-item .remove-file {
      position: absolute;
      top: 5px;
      right: 5px;
      background: rgba(220, 53, 69, 0.9);
      color: white;
      border: none;
      border-radius: 50%;
      width: 24px;
      height: 24px;
      font-size: 12px;
      cursor: pointer;
    }
    /* Role-specific declaration notice */
    .role-declaration-notice {
      background: linear-gradient(135deg, #f5f3ff, #e9d5ff);
      border-left: 4px solid var(--gdms-purple);
      padding: 15px;
      border-radius: 6px;
      margin-bottom: 20px;
    }
    .role-declaration-notice h4 {
      color: var(--gdms-purple);
      margin-bottom: 5px;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    /* Committee Meeting Styles */
    .meeting-card {
      background: white;
      border-radius: 10px;
      padding: 20px;
      border-left: 4px solid var(--gdms-purple);
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    .vote-button {
      padding: 6px 12px;
      border-radius: 20px;
      font-size: 0.8rem;
      font-weight: 500;
      border: none;
      cursor: pointer;
      transition: all 0.3s;
    }
    .vote-yes { background: #d4edda; color: #155724; }
    .vote-no { background: #f8d7da; color: #721c24; }
    .vote-abstain { background: #e2e3e5; color: #383d41; }
    .vote-yes:hover { background: #c3e6cb; }
    .vote-no:hover { background: #f5c6cb; }
    .vote-abstain:hover { background: #d6d8db; }
  </style>
</head>
<body class="bg-gray-50">
  <!-- AUTHENTICATION CHECK -->
  <script>
    (function() {
      // Check if user is authenticated
      const user = localStorage.getItem('gdms_user');
      const token = localStorage.getItem('gdms_token');
      
      if (!user || !token) {
        console.log('üö´ No authentication found. Redirecting to login...');
        // Clear any leftover data
        localStorage.removeItem('gdms_user');
        localStorage.removeItem('gdms_token');
        sessionStorage.removeItem('gdms_session');
        // Redirect immediately
        window.location.href = 'login.html';
        return;
      }
      
      // Parse user data
      let userData;
      try {
        userData = JSON.parse(user);
      } catch (e) {
        console.error('Error parsing user data:', e);
        window.location.href = 'login.html';
        return;
      }
      
      // Check if user is authorized for this dashboard
      const currentPage = window.location.pathname.split('/').pop();
      const userRole = userData.role;
      
      // Only gac-member role should access gac.html
      if (userRole !== 'gac-member') {
        console.log(`üö´ User role ${userRole} not authorized for gac.html`);
        console.log(`‚û°Ô∏è Redirecting to correct dashboard...`);
        
        // Redirect to correct dashboard based on role
        const redirectMap = {
          'acc-admin': 'acc-dashboard.html',
          'public-servant': 'public-official.html',
          'gda': 'gda.html',
          'hoa': 'hoa.html',
          'gac-member': 'gac.html'
        };
        
        const correctPage = redirectMap[userRole] || 'login.html';
        window.location.href = correctPage;
        return;
      }
      
      console.log(`‚úÖ User ${userData.name} (${userRole}) authorized for gac.html`);
      
      // Store user data globally for JavaScript to use
      window.realUserData = userData;
    })();
  </script>

  <!-- Loading Screen -->
  <div id="loading-screen">
    <div class="loading-spinner"></div>
    <div class="loading-text">Loading GDMS...</div>
  </div>

  <!-- User Info Bar -->
  <div id="user-info-bar" class="bg-gray-100 px-6 py-3 border-b flex justify-between items-center" style="display: none;">
    <div class="flex items-center space-x-4">
      <div class="user-avatar w-10 h-10 rounded-full bg-gradient-to-r from-purple-600 to-blue-600 flex items-center justify-center text-white font-bold" id="user-avatar">KD</div>
      <div>
        <h4 id="user-name" class="font-medium text-gray-900">Loading...</h4>
        <p class="text-sm text-gray-600">
          <span class="role-badge role-gac-member">GAC Member</span>
          <span class="agency-badge" id="user-agency">Loading...</span>
        </p>
      </div>
    </div>
    <button id="logout-button" class="px-4 py-2 bg-red-600 text-white rounded-md flex items-center gap-2 hover:bg-red-700">
      <i class="fas fa-sign-out-alt"></i> Logout
    </button>
  </div>

  <!-- Header -->
  <header id="main-header" class="bg-white shadow-sm border-b" style="display: none;">
    <div class="max-w-7xl mx-auto px-6 py-4 flex justify-between items-center">
      <div class="flex items-center space-x-3">
        <div class="bg-red-600 text-white p-2 rounded">
          <i class="fas fa-gift text-xl"></i>
        </div>
        <div>
          <h1 class="text-xl font-bold text-gray-900">GDMS</h1>
          <p class="text-xs text-gray-500">Online Gift Declaration and Management System</p>
        </div>
      </div>
      <div class="flex items-center space-x-4">
        <div class="flex items-center space-x-2">
          <div class="w-8 h-8 rounded-full bg-gradient-to-r from-purple-600 to-blue-600 flex items-center justify-center text-white text-sm font-bold" id="header-avatar">KD</div>
          <div class="text-right">
            <div class="font-medium text-gray-900" id="header-user-name">Loading...</div>
            <div class="text-xs text-gray-500" id="header-user-role">GAC Member</div>
          </div>
        </div>
      </div>
    </div>
  </header>

  <!-- Navigation -->
  <nav id="main-navigation" class="bg-white border-b" style="display: none;">
    <div class="max-w-7xl mx-auto px-6">
      <div class="flex space-x-1 py-2">
        <a href="#" class="nav-tab active flex items-center px-4 py-2 text-sm font-medium rounded-t-lg border-b-2 border-purple-600 text-gray-900" data-page="dashboard">
          <i class="fas fa-home mr-2"></i> Dashboard
        </a>
        <a href="#" class="nav-tab flex items-center px-4 py-2 text-sm font-medium rounded-t-lg border-b-2 border-transparent hover:bg-gray-50" data-page="declare">
          <i class="fas fa-plus-circle mr-2"></i> Declare Gift
        </a>
        <a href="#" class="nav-tab flex items-center px-4 py-2 text-sm font-medium rounded-t-lg border-b-2 border-transparent hover:bg-gray-50" data-page="my-gifts">
          <i class="fas fa-gifts mr-2"></i> My Gifts
        </a>
        <a href="#" class="nav-tab flex items-center px-4 py-2 text-sm font-medium rounded-t-lg border-b-2 border-transparent hover:bg-gray-50" data-page="review">
          <i class="fas fa-users mr-2"></i> Committee Review
        </a>
        <a href="#" class="nav-tab flex items-center px-4 py-2 text-sm font-medium rounded-t-lg border-b-2 border-transparent hover:bg-gray-50" data-page="minutes">
          <i class="fas fa-file-alt mr-2"></i> Meeting Minutes
        </a>
        <a href="#" class="nav-tab flex items-center px-4 py-2 text-sm font-medium rounded-t-lg border-b-2 border-transparent hover:bg-gray-50" data-page="knowledge">
          <i class="fas fa-info-circle mr-2"></i> Guidance
        </a>
      </div>
    </div>
  </nav>

  <!-- Main Content -->
  <main id="main-content" class="max-w-7xl mx-auto px-6 py-8" style="display: none;">
    <!-- DASHBOARD -->
    <div id="dashboard" class="page active">
      <div id="gac-dashboard" class="role-dashboard">
        <div class="bg-gradient-to-r from-purple-600 to-blue-600 rounded-lg p-6 text-white mb-8">
          <h2 class="text-2xl font-bold">Gift Administration Committee</h2>
          <p class="opacity-90">Agency: <span id="gac-agency-name">Anti-Corruption Commission</span></p>
          <p class="text-sm mt-2"><i class="fas fa-info-circle mr-1"></i> Appointed by HoA per Rule 19. Reviews HoA gifts only.</p>
        </div>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
          <div class="stat-card">
            <p class="text-sm text-gray-500">My Declarations</p>
            <p class="text-3xl font-bold text-gray-900" id="gac-personal-declarations">2</p>
            <div class="mt-2 text-xs text-purple-600">
              <i class="fas fa-user-circle mr-1"></i> Reviewed by HoA
            </div>
          </div>
          <div class="stat-card">
            <p class="text-sm text-gray-500">HoA Gifts Pending Review</p>
            <p class="text-3xl font-bold text-gray-900" id="gac-pending-review">3</p>
            <div class="mt-2">
              <span class="text-xs text-red-600">
                <i class="fas fa-exclamation-circle mr-1"></i> Per Rule 21(a)
              </span>
            </div>
          </div>
          <div class="stat-card">
            <p class="text-sm text-gray-500">Next GAC Meeting</p>
            <p class="text-3xl font-bold text-purple-700">28 Dec 2025</p>
            <div class="mt-2 text-xs text-yellow-600">
              <i class="fas fa-calendar-alt mr-1"></i> In 4 days
            </div>
          </div>
        </div>
        <div class="bg-white p-6 rounded-lg shadow mb-8">
          <h3 class="text-lg font-bold text-gray-900 mb-4"><i class="fas fa-bolt mr-2"></i> Quick Actions</h3>
          <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
            <button class="action-btn" onclick="navigateTo('declare')">
              <i class="fas fa-gift"></i>
              <span>Declare Gift</span>
            </button>
            <button class="action-btn" onclick="navigateTo('review')">
              <i class="fas fa-users"></i>
              <span>Review HoA Gifts</span>
            </button>
            <button class="action-btn" onclick="scheduleGACMeeting()">
              <i class="fas fa-calendar-alt"></i>
              <span>Schedule Meeting</span>
            </button>
          </div>
        </div>
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
          <div class="bg-white p-6 rounded-lg shadow">
            <h3 class="font-bold text-gray-800 mb-4"><i class="fas fa-history text-gray-500 mr-2"></i> Recent Committee Decisions</h3>
            <ul class="space-y-4" id="recent-decisions">
              <li class="flex items-start">
                <i class="fas fa-times-circle text-red-500 mt-1 mr-3"></i>
                <div>
                  <span class="font-medium">GDMS-2025-0998 (HoA)</span><br>
                  <span class="text-gray-600">Gold pendant (Nu. 22,500)</span><br>
                  <span class="text-xs text-gray-500">28 Dec 2025 ‚Ä¢ <span class="status-badge status-returned">Returned to donor</span></span>
                </div>
              </li>
              <li class="flex items-start">
                <i class="fas fa-check-circle text-green-500 mt-1 mr-3"></i>
                <div>
                  <span class="font-medium">GDMS-2025-0702 (HoA)</span><br>
                  <span class="text-gray-600">Traditional scarf (Nu. 1,800)</span><br>
                  <span class="text-xs text-gray-500">15 Dec 2025 ‚Ä¢ <span class="status-badge status-approved">Approved for retention</span></span>
                </div>
              </li>
              <li class="flex items-start">
                <i class="fas fa-exchange-alt text-blue-500 mt-1 mr-3"></i>
                <div>
                  <span class="font-medium">GDMS-2025-0651 (HoA)</span><br>
                  <span class="text-gray-600">Cash gift Nu. 15,000</span><br>
                  <span class="text-xs text-gray-500">10 Dec 2025 ‚Ä¢ <span class="status-badge status-returned">Deposited to Treasury</span></span>
                </div>
              </li>
            </ul>
          </div>
          <div class="bg-white p-6 rounded-lg shadow">
            <h3 class="font-bold text-gray-800 mb-4"><i class="fas fa-users text-purple-500 mr-2"></i> GAC Committee Members</h3>
            <div class="space-y-3">
              <div class="flex items-center p-3 bg-purple-50 rounded">
                <div class="w-10 h-10 rounded-full bg-purple-100 flex items-center justify-center mr-3">
                  <i class="fas fa-user text-purple-600"></i>
                </div>
                <div>
                  <p class="font-bold text-gray-900">Sonam Choden</p>
                  <p class="text-sm text-gray-600">Chairperson ‚Ä¢ Director, Legal</p>
                </div>
              </div>
              <div class="flex items-center p-3 bg-blue-50 rounded">
                <div class="w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center mr-3">
                  <i class="fas fa-user text-blue-600"></i>
                </div>
                <div>
                  <p class="font-bold text-gray-900">Dorji Wangmo</p>
                  <p class="text-sm text-gray-600">Member ‚Ä¢ Director, Finance</p>
                </div>
              </div>
              <div class="flex items-center p-3 bg-green-50 rounded">
                <div class="w-10 h-10 rounded-full bg-green-100 flex items-center justify-center mr-3">
                  <i class="fas fa-user text-green-600"></i>
                </div>
                <div>
                  <p class="font-bold text-gray-900" id="current-gac-member">Karma Dorji (You)</p>
                  <p class="text-sm text-gray-600">Member ‚Ä¢ Director, Administration</p>
                </div>
              </div>
            </div>
            <div class="mt-4 p-3 bg-yellow-50 rounded text-sm">
              <i class="fas fa-info-circle text-yellow-600 mr-2"></i>
              <span class="text-yellow-700">All members appointed by HoA. Quorum: 3 members minimum.</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- DECLARE GIFT -->
    <div id="declare" class="page">
      <div class="mb-6">
        <h2 class="text-2xl font-bold text-gray-900">Declare a Gift</h2>
        <p class="text-gray-600">Submit within <strong>24 hours</strong>. <span class="text-purple-700 font-medium">As GAC member, your gifts go to GDA ‚Üí HoA for decision.</span></p>
      </div>
      <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
        <div class="lg:col-span-2">
          <div class="bg-white rounded-lg shadow p-6">
            <div class="role-declaration-notice">
              <h4><i class="fas fa-info-circle"></i> Declaration as GAC Member</h4>
              <p>Your declaration will be <strong>forwarded to GDA</strong> who will send it to HoA for final decision (Rule 21b).</p>
            </div>
            <div id="alert-container" class="mb-6"></div>
            <form id="gift-declaration-form">
              <div class="form-group">
                <label class="form-label">Date Gift Received <span class="text-red-600">*</span></label>
                <input type="date" class="form-control" id="gift-date" required>
              </div>
              <div class="form-row">
                <div class="form-group">
                  <label class="form-label">Value (Nu.) <span class="text-red-600">*</span></label>
                  <input type="number" class="form-control" id="gift-value" min="0" step="0.01" required>
                </div>
                <div class="form-group">
                  <label class="form-label">Category <span class="text-red-600">*</span></label>
                  <select class="form-control" id="gift-category" required>
                    <option value="">Select</option>
                    <option value="cash">Cash</option>
                    <option value="kind">In-kind</option>
                    <option value="service">Service/Favour</option>
                    <option value="entertainment">Entertainment</option>
                    <option value="travel">Travel/Hospitality</option>
                    <option value="other">Other</option>
                  </select>
                </div>
              </div>
              <div class="form-group">
                <label class="form-label">Description <span class="text-red-600">*</span></label>
                <textarea class="form-control" id="gift-description" rows="3" required></textarea>
              </div>
              <div class="form-group">
                <label class="form-label">Upload Photos (Optional)</label>
                <div class="file-upload-container" id="file-upload-area">
                  <i class="fas fa-cloud-upload-alt text-3xl text-gray-400 mb-2"></i>
                  <p class="font-medium text-gray-700">Drag & drop or click to browse</p>
                  <input type="file" id="gift-photos" accept="image/*" multiple style="display: none;">
                </div>
                <div class="file-preview" id="file-preview-container"></div>
              </div>
              <div class="form-group">
                <label class="form-label">Source/Donor <span class="text-red-600">*</span></label>
                <input type="text" class="form-control" id="gift-source" required>
              </div>
              <div class="form-row">
                <div class="form-group">
                  <label class="form-label">Relationship <span class="text-red-600">*</span></label>
                  <select class="form-control" id="donor-relationship" required>
                    <option value="">Select</option>
                    <option value="family">Family Member</option>
                    <option value="friend">Friend</option>
                    <option value="business">Business Associate</option>
                    <option value="subordinate">Subordinate</option>
                    <option value="foreign">Foreign Entity</option>
                    <option value="other">Other</option>
                  </select>
                </div>
                <div class="form-group">
                  <label class="form-label">Occasion</label>
                  <input type="text" class="form-control" id="gift-occasion">
                </div>
              </div>
              <div class="form-group">
                <label class="form-label">Current Location/Handling</label>
                <textarea class="form-control" id="gift-location" rows="2" placeholder="Where is the gift currently kept?"></textarea>
              </div>
              <div class="form-group">
                <div class="flex items-center">
                  <input type="checkbox" id="prohibited-check" class="mr-2" required>
                  <label for="prohibited-check">I confirm this gift is not from a prohibited source (Rule 6)</label>
                </div>
              </div>
              <div class="flex justify-end space-x-3 mt-8">
                <button type="button" class="btn btn-secondary" onclick="navigateTo('dashboard')">
                  <i class="fas fa-times mr-2"></i> Cancel
                </button>
                <button type="submit" class="btn btn-primary">
                  <i class="fas fa-paper-plane mr-2"></i> Submit to GDA
                </button>
              </div>
            </form>
          </div>
        </div>
        <div class="space-y-6">
          <div class="bg-purple-50 border-l-4 border-purple-500 p-4 rounded">
            <h4 class="font-bold text-purple-800 mb-2"><i class="fas fa-info-circle mr-2"></i> GAC Member Declaration Path</h4>
            <p class="text-sm text-purple-700">
              1. <strong>You declare gift</strong><br>
              2. <strong>Forwarded to GDA</strong><br>
              3. <strong>GDA sends to HoA</strong><br>
              4. <strong>HoA makes final decision</strong>
            </p>
          </div>
          <div class="bg-yellow-50 border-l-4 border-yellow-500 p-4 rounded">
            <h4 class="font-bold text-yellow-800 mb-2"><i class="fas fa-exclamation-triangle mr-2"></i> Key Rules for GAC Members</h4>
            <p class="text-sm text-yellow-700">
              ‚Ä¢ <strong>Rule 13:</strong> Declare within 24h<br>
              ‚Ä¢ <strong>Rule 21b:</strong> GAC gifts ‚Üí GDA ‚Üí HoA<br>
              ‚Ä¢ <strong>Rule 21a:</strong> Review HoA gifts only<br>
              ‚Ä¢ <strong>You cannot review</strong> own gifts
            </p>
          </div>
          <div class="bg-blue-50 border-l-4 border-blue-500 p-4 rounded">
            <h4 class="font-bold text-blue-800 mb-2"><i class="fas fa-users mr-2"></i> GAC Responsibilities</h4>
            <p class="text-sm text-blue-700">
              ‚Ä¢ Review <strong>HoA gifts only</strong><br>
              ‚Ä¢ Decisions by majority vote<br>
              ‚Ä¢ Quorum: 3 members minimum<br>
              ‚Ä¢ Record meeting minutes
            </p>
          </div>
        </div>
      </div>
    </div>

    <!-- MY GIFTS -->
    <div id="my-gifts" class="page">
      <div class="mb-6">
        <h2 class="text-2xl font-bold text-gray-900">My Gift Declarations</h2>
        <p class="text-gray-600">Your gifts are reviewed by HoA (not by GAC) per Rule 21b.</p>
      </div>
      <div class="bg-white rounded-lg shadow overflow-hidden">
        <div class="overflow-x-auto">
          <table class="table">
            <thead>
              <tr>
                <th>Ref No.</th>
                <th>Date</th>
                <th>Description</th>
                <th>Value</th>
                <th>Status</th>
                <th>Review Stage</th>
                <th>Action</th>
              </tr>
            </thead>
            <tbody id="my-gifts-table">
              <tr>
                <td>GDMS-2025-1011</td>
                <td>2025-12-23</td>
                <td>Wooden desk organizer (conference)</td>
                <td>Nu. 2,800</td>
                <td><span class="status-badge status-pending">Pending</span></td>
                <td>Awaiting HoA Decision</td>
                <td>
                  <button class="btn btn-primary btn-sm" onclick="viewGiftDetails('GDMS-2025-1011')">
                    <i class="fas fa-eye"></i> View
                  </button>
                </td>
              </tr>
              <tr>
                <td>GDMS-2025-0815</td>
                <td>2025-10-30</td>
                <td>Coffee table book (colleague)</td>
                <td>Nu. 1,200</td>
                <td><span class="status-badge status-approved">Approved</span></td>
                <td>HoA Approved</td>
                <td>
                  <button class="btn btn-primary btn-sm" onclick="viewGiftDetails('GDMS-2025-0815')">
                    <i class="fas fa-eye"></i> View
                  </button>
                </td>
              </tr>
              <tr>
                <td>GDMS-2025-0995</td>
                <td>2025-12-15</td>
                <td>Hotel accommodation</td>
                <td>Nu. 18,000</td>
                <td><span class="status-badge status-forwarded">Forwarded to HoA</span></td>
                <td>With HoA for Decision</td>
                <td>
                  <button class="btn btn-primary btn-sm" onclick="viewGiftDetails('GDMS-2025-0995')">
                    <i class="fas fa-eye"></i> View
                  </button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <div class="mt-6 bg-blue-50 border-l-4 border-blue-500 p-4 rounded">
        <h4 class="font-bold text-blue-800 mb-2"><i class="fas fa-info-circle mr-2"></i> Note on GAC Member Gift Review</h4>
        <p class="text-sm text-blue-700">
          As GAC member, your gifts are reviewed by the Head of Agency (HoA) per <strong>Rule 21(b)</strong>. 
          You cannot review your own declarations. All GAC member gifts go through GDA to HoA.
        </p>
      </div>
    </div>

    <!-- COMMITTEE REVIEW -->
    <div id="review" class="page">
      <div class="mb-6">
        <h2 class="text-2xl font-bold text-gray-900">Committee Review</h2>
        <p class="text-gray-600">Collaborative review of gifts declared by the <strong>Head of Agency only</strong> (Rule 21a).</p>
      </div>
      
      <div class="bg-white rounded-lg shadow overflow-hidden mb-8">
        <div class="p-4 border-b bg-purple-50">
          <div class="flex justify-between items-center">
            <h3 class="font-bold text-purple-800"><i class="fas fa-users mr-2"></i> Current GAC Agenda</h3>
            <span class="text-sm text-purple-600"><span id="agenda-count">3</span> HoA gifts for review</span>
          </div>
        </div>
        <div class="overflow-x-auto">
          <table class="table">
            <thead>
              <tr>
                <th>Ref No.</th>
                <th>Declarant</th>
                <th>Description</th>
                <th>Value</th>
                <th>GDA Comments</th>
                <th>Your Vote</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="gac-review-table">
              <tr>
                <td>GDMS-2025-0998</td>
                <td>Pema Lhamo (HoA)</td>
                <td>Gold pendant (family)</td>
                <td>Nu. 22,500</td>
                <td>Family gift, assess proportionality</td>
                <td><span class="status-badge status-pending">Not Voted</span></td>
                <td>
                  <button class="btn btn-primary btn-sm" onclick="reviewHoAGift('GDMS-2025-0998')">
                    <i class="fas fa-vote-yea"></i> Review & Vote
                  </button>
                </td>
              </tr>
              <tr>
                <td>GDMS-2025-1009</td>
                <td>Pema Lhamo (HoA)</td>
                <td>Laptop bag (conference)</td>
                <td>Nu. 4,200</td>
                <td>Conference souvenir, nominal value</td>
                <td><span class="status-badge status-pending">Not Voted</span></td>
                <td>
                  <button class="btn btn-primary btn-sm" onclick="reviewHoAGift('GDMS-2025-1009')">
                    <i class="fas fa-vote-yea"></i> Review & Vote
                  </button>
                </td>
              </tr>
              <tr>
                <td>GDMS-2025-1010</td>
                <td>Pema Lhamo (HoA)</td>
                <td>Traditional kira (elder)</td>
                <td>Nu. 6,800</td>
                <td>Cultural gift from elder, assess propriety</td>
                <td><span class="status-badge status-pending">Not Voted</span></td>
                <td>
                  <button class="btn btn-primary btn-sm" onclick="reviewHoAGift('GDMS-2025-1010')">
                    <i class="fas fa-vote-yea"></i> Review & Vote
                  </button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      
      <div class="meeting-card mb-8">
        <h3 class="text-lg font-bold text-gray-900 mb-4"><i class="fas fa-calendar-alt text-purple-600 mr-2"></i> Next GAC Meeting</h3>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div>
            <p class="text-sm text-gray-600">Date & Time</p>
            <p class="font-bold text-gray-900">28 December 2025 ‚Ä¢ 2:30 PM</p>
          </div>
          <div>
            <p class="text-sm text-gray-600">Venue</p>
            <p class="font-bold text-gray-900">ACC Conference Room</p>
          </div>
          <div class="md:col-span-2">
            <p class="text-sm text-gray-600">Agenda</p>
            <p class="font-bold text-gray-900">Review of HoA gift declarations (3 items)</p>
            <div class="mt-2">
              <button class="btn btn-primary btn-sm mr-2" onclick="joinMeeting()">
                <i class="fas fa-video mr-1"></i> Join Meeting
              </button>
              <button class="btn btn-secondary btn-sm" onclick="viewAgenda()">
                <i class="fas fa-file-alt mr-1"></i> View Full Agenda
              </button>
            </div>
          </div>
        </div>
      </div>
      
      <div class="bg-white p-6 rounded-lg shadow">
        <h3 class="text-lg font-bold text-gray-900 mb-4">Committee Protocol (Rule 21a)</h3>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div>
            <h4 class="font-bold text-gray-800 mb-2">Voting Rules</h4>
            <ul class="list-disc pl-5 space-y-1 text-sm text-gray-600">
              <li>Quorum: ‚â•3 members must participate</li>
              <li>Decisions by simple majority vote</li>
              <li>HoA must recuse from own gift review</li>
              <li>All votes recorded in minutes</li>
            </ul>
          </div>
          <div>
            <h4 class="font-bold text-gray-800 mb-2">Decision Options</h4>
            <ul class="list-disc pl-5 space-y-1 text-sm text-gray-600">
              <li><strong>Approve Retention:</strong> HoA may keep gift</li>
              <li><strong>Return to Donor:</strong> Gift must be returned</li>
              <li><strong>Forfeit to State:</strong> Gift deposited to Treasury</li>
              <li><strong>Impose Conditions:</strong> Retention with restrictions</li>
            </ul>
          </div>
        </div>
        <div class="mt-4 p-3 bg-yellow-50 rounded text-sm">
          <i class="fas fa-exclamation-triangle text-yellow-600 mr-2"></i>
          <span class="text-yellow-700">GAC reviews <strong>HoA gifts only</strong>. GAC member gifts are reviewed by HoA.</span>
        </div>
      </div>
    </div>

    <!-- MEETING MINUTES -->
    <div id="minutes" class="page">
      <div class="mb-6">
        <h2 class="text-2xl font-bold text-gray-900">Meeting Minutes</h2>
        <p class="text-gray-600">Record of all GAC meetings and decisions.</p>
      </div>
      
      <div class="bg-white rounded-lg shadow overflow-hidden mb-8">
        <div class="p-4 border-b">
          <h3 class="text-lg font-bold text-gray-900">GAC Meeting Records</h3>
        </div>
        <div class="overflow-x-auto">
          <table class="table">
            <thead>
              <tr>
                <th>Meeting Date</th>
                <th>Minutes Ref</th>
                <th>Chairperson</th>
                <th>Gifts Reviewed</th>
                <th>Decisions</th>
                <th>Status</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="minutes-table">
              <tr>
                <td>2025-12-28</td>
                <td>GAC-MIN-2025-008</td>
                <td>Sonam Choden</td>
                <td>3 (HoA gifts)</td>
                <td>2 Approved, 1 Returned</td>
                <td><span class="status-badge status-pending">Upcoming</span></td>
                <td>
                  <button class="btn btn-primary btn-sm" onclick="viewMinutes('GAC-MIN-2025-008')">
                    <i class="fas fa-eye"></i> View
                  </button>
                </td>
              </tr>
              <tr>
                <td>2025-12-15</td>
                <td>GAC-MIN-2025-007</td>
                <td>Sonam Choden</td>
                <td>2 (HoA gifts)</td>
                <td>1 Approved, 1 Forfeited</td>
                <td><span class="status-badge status-approved">Approved</span></td>
                <td>
                  <button class="btn btn-primary btn-sm" onclick="viewMinutes('GAC-MIN-2025-007')">
                    <i class="fas fa-eye"></i> View
                  </button>
                </td>
              </tr>
              <tr>
                <td>2025-11-28</td>
                <td>GAC-MIN-2025-006</td>
                <td>Dorji Wangmo</td>
                <td>1 (HoA gift)</td>
                <td>1 Approved with Conditions</td>
                <td><span class="status-badge status-approved">Approved</span></td>
                <td>
                  <button class="btn btn-primary btn-sm" onclick="viewMinutes('GAC-MIN-2025-006')">
                    <i class="fas fa-eye"></i> View
                  </button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      
      <div class="bg-white p-6 rounded-lg shadow">
        <h3 class="text-lg font-bold text-gray-900 mb-4">Minutes Requirements</h3>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div>
            <h4 class="font-bold text-gray-800 mb-2">Required Content</h4>
            <ul class="list-disc pl-5 space-y-1 text-sm text-gray-600">
              <li>Date, time, and venue of meeting</li>
              <li>Names of members present</li>
              <li>Gifts reviewed and decisions</li>
              <li>Voting results (including dissenting views)</li>
              <li>Justification for each decision</li>
              <li>Rule citations for decisions</li>
            </ul>
          </div>
          <div>
            <h4 class="font-bold text-gray-800 mb-2">Documentation Rules</h4>
            <ul class="list-disc pl-5 space-y-1 text-sm text-gray-600">
              <li>Minutes must be signed by Chairperson</li>
              <li>Filed in Gift Register (Rule 28)</li>
              <li>Available for audit by RAA</li>
              <li>Retained for minimum 5 years</li>
              <li>Communicated to HoA within 2 days</li>
            </ul>
          </div>
        </div>
        <div class="mt-4 flex space-x-3">
          <button class="btn btn-primary" onclick="createMinutes()">
            <i class="fas fa-file-alt mr-2"></i> Create New Minutes
          </button>
          <button class="btn btn-secondary" onclick="exportMinutes()">
            <i class="fas fa-download mr-2"></i> Export All Minutes
          </button>
        </div>
      </div>
    </div>

    <!-- GUIDANCE -->
    <div id="knowledge" class="page">
      <div class="mb-6">
        <h2 class="text-2xl font-bold text-gray-900">Guidance & Resources</h2>
        <p class="text-gray-600">Review workflows, Rule summaries, and documentation standards.</p>
      </div>
      <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
        <div class="bg-white rounded-lg shadow p-6">
          <div class="text-purple-600 text-3xl mb-4">
            <i class="fas fa-book"></i>
          </div>
          <h3 class="text-xl font-bold text-gray-900 mb-2">Rules & Regulations</h3>
          <p class="text-gray-600 mb-4">Complete text of the Gift Rules 2022 with official commentary.</p>
          <button class="btn btn-primary" onclick="downloadResource('rules')">
            <i class="fas fa-download mr-2"></i> Download PDF
          </button>
        </div>
        <div class="bg-white rounded-lg shadow p-6">
          <div class="text-green-600 text-3xl mb-4">
            <i class="fas fa-file-alt"></i>
          </div>
          <h3 class="text-xl font-bold text-gray-900 mb-2">GAC Workflow Guide</h3>
          <p class="text-gray-600 mb-4">Step-by-step procedures for GAC meetings and decisions.</p>
          <button class="btn btn-primary" onclick="showGACWorkflow()">
            <i class="fas fa-external-link-alt mr-2"></i> View Guide
          </button>
        </div>
        <div class="bg-white rounded-lg shadow p-6">
          <div class="text-blue-600 text-3xl mb-4">
            <i class="fas fa-question-circle"></i>
          </div>
          <h3 class="text-xl font-bold text-gray-900 mb-2">FAQs & Guidance</h3>
          <p class="text-gray-600 mb-4">Common questions and interpretive guidance on gift rules.</p>
          <button class="btn btn-primary" onclick="showFAQs()">
            <i class="fas fa-external-link-alt mr-2"></i> View FAQs
          </button>
        </div>
      </div>
      <div class="mt-8 bg-white rounded-lg shadow p-6">
        <h3 class="text-lg font-bold text-gray-900 mb-4">GAC-Specific Guidance</h3>
        <div class="space-y-4">
          <div class="border-l-4 border-purple-500 pl-4 py-2">
            <h4 class="font-bold text-gray-900">Rule 21a: GAC Review of HoA Gifts</h4>
            <p class="text-gray-600 text-sm">All gifts received by the HoA must be reviewed by the Gift Administration Committee.</p>
            <button class="btn btn-primary btn-sm mt-2" onclick="showRuleDetails('Rule 21a')">View Details</button>
          </div>
          <div class="border-l-4 border-green-500 pl-4 py-2">
            <h4 class="font-bold text-gray-900">Rule 21b: GAC Member Gift Review</h4>
            <p class="text-gray-600 text-sm">Gifts received by GAC members are reviewed by HoA (not by GAC).</p>
            <button class="btn btn-primary btn-sm mt-2" onclick="showRuleDetails('Rule 21b')">View Details</button>
          </div>
          <div class="border-l-4 border-yellow-500 pl-4 py-2">
            <h4 class="font-bold text-gray-900">Rule 19: GAC Constitution</h4>
            <p class="text-gray-600 text-sm">HoA appoints GAC members (minimum 3). GDA convenes meetings.</p>
            <button class="btn btn-primary btn-sm mt-2" onclick="showRuleDetails('Rule 19')">View Details</button>
          </div>
        </div>
      </div>
    </div>
  </main>

  <!-- MODALS -->
  <div id="modal-container" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 id="modal-title"></h3>
        <button class="modal-close" onclick="closeModal()">&times;</button>
      </div>
      <div class="modal-body" id="modal-body"></div>
      <div class="modal-footer" id="modal-footer"></div>
    </div>
  </div>

  <!-- CONNECTION STATUS -->
  <div id="connection-status">
    <i class="fas fa-wifi"></i>
    <span>Online</span>
  </div>

  <script>
  // Global Variables
  let currentUser = null;
  let uploadedFiles = [];
  let currentModal = null;

  // DOM Content Loaded
  document.addEventListener('DOMContentLoaded', function() {
    // Initialize the dashboard
    initDashboard();
    
    // Set up event listeners
    setupEventListeners();
    
    // Show the interface
    setTimeout(() => {
      document.getElementById('loading-screen').style.opacity = '0';
      setTimeout(() => {
        document.getElementById('loading-screen').style.display = 'none';
        document.getElementById('user-info-bar').style.display = 'flex';
        document.getElementById('main-header').style.display = 'block';
        document.getElementById('main-navigation').style.display = 'block';
        document.getElementById('main-content').style.display = 'block';
        
        // Set default date to today
        const today = new Date().toISOString().split('T')[0];
        const dateInput = document.getElementById('gift-date');
        if (dateInput) dateInput.value = today;
      }, 500);
    }, 1000);
  });

  // Initialize Dashboard
  function initDashboard() {
    // Get user data from localStorage or global variable
    const userData = window.realUserData || JSON.parse(localStorage.getItem('gdms_user') || '{}');
    currentUser = userData;
    
    // Update user info
    updateUserInfo(userData);
    
    // Load dashboard data
    loadDashboardData();
  }

  // Update User Information
  function updateUserInfo(user) {
    const name = user.name || 'Karma Dorji';
    const agency = user.agency || 'Anti-Corruption Commission';
    const role = user.role || 'gac-member';
    
    // Update all name displays
    document.getElementById('user-name').textContent = name;
    document.getElementById('header-user-name').textContent = name;
    document.getElementById('gac-agency-name').textContent = agency;
    document.getElementById('user-agency').textContent = agency;
    document.getElementById('current-gac-member').textContent = `${name} (You)`;
    
    // Update avatar initials
    const initials = name.split(' ').map(n => n[0]).join('').toUpperCase();
    document.getElementById('user-avatar').textContent = initials;
    document.getElementById('header-avatar').textContent = initials;
  }

  // Load Dashboard Data
  function loadDashboardData() {
    // Simulate API call for dashboard statistics
    setTimeout(() => {
      // These would typically come from an API
      const stats = {
        personalDeclarations: 2,
        pendingReview: 3,
        nextMeeting: '28 Dec 2025'
      };
      
      document.getElementById('gac-personal-declarations').textContent = stats.personalDeclarations;
      document.getElementById('gac-pending-review').textContent = stats.pendingReview;
      
      // Update next meeting date
      const nextMeetingEl = document.querySelector('.stat-card:nth-child(3) .text-3xl');
      if (nextMeetingEl) {
        nextMeetingEl.textContent = stats.nextMeeting;
      }
    }, 500);
  }

  // Set Up Event Listeners
  function setupEventListeners() {
    // Navigation tabs
    document.querySelectorAll('.nav-tab').forEach(tab => {
      tab.addEventListener('click', function(e) {
        e.preventDefault();
        const page = this.dataset.page;
        navigateTo(page);
      });
    });
    
    // Logout button
    document.getElementById('logout-button').addEventListener('click', logout);
    
    // Gift declaration form
    const giftForm = document.getElementById('gift-declaration-form');
    if (giftForm) {
      giftForm.addEventListener('submit', handleGiftDeclaration);
    }
    
    // File upload
    const fileUpload = document.getElementById('file-upload-area');
    const fileInput = document.getElementById('gift-photos');
    
    if (fileUpload && fileInput) {
      fileUpload.addEventListener('click', () => fileInput.click());
      fileInput.addEventListener('change', handleFileSelect);
      
      // Drag and drop
      fileUpload.addEventListener('dragover', (e) => {
        e.preventDefault();
        fileUpload.classList.add('dragover');
      });
      
      fileUpload.addEventListener('dragleave', () => {
        fileUpload.classList.remove('dragover');
      });
      
      fileUpload.addEventListener('drop', (e) => {
        e.preventDefault();
        fileUpload.classList.remove('dragover');
        if (e.dataTransfer.files.length) {
          fileInput.files = e.dataTransfer.files;
          handleFileSelect({ target: fileInput });
        }
      });
    }
  }

  // Navigation Function
  function navigateTo(pageId) {
    // Update active tab
    document.querySelectorAll('.nav-tab').forEach(tab => {
      tab.classList.remove('active');
      tab.classList.remove('border-purple-600', 'text-gray-900');
      tab.classList.add('border-transparent');
    });
    
    const activeTab = document.querySelector(`.nav-tab[data-page="${pageId}"]`);
    if (activeTab) {
      activeTab.classList.add('active', 'border-purple-600', 'text-gray-900');
      activeTab.classList.remove('border-transparent');
    }
    
    // Update active page
    document.querySelectorAll('.page').forEach(page => {
      page.classList.remove('active');
    });
    
    const targetPage = document.getElementById(pageId);
    if (targetPage) {
      targetPage.classList.add('active');
      window.scrollTo(0, 0);
    }
  }

  // Handle Gift Declaration
  function handleGiftDeclaration(e) {
    e.preventDefault();
    
    // Get form values
    const giftValue = parseFloat(document.getElementById('gift-value').value);
    const giftDate = document.getElementById('gift-date').value;
    const giftDescription = document.getElementById('gift-description').value;
    const giftSource = document.getElementById('gift-source').value;
    
    // Validation
    if (!giftDate) {
      showAlert('error', 'Please select the date the gift was received.');
      return;
    }
    
    if (!giftValue || giftValue <= 0) {
      showAlert('error', 'Please enter a valid gift value.');
      return;
    }
    
    if (!giftDescription.trim()) {
      showAlert('error', 'Please provide a description of the gift.');
      return;
    }
    
    if (!giftSource.trim()) {
      showAlert('error', 'Please provide the source/donor information.');
      return;
    }
    
    if (!document.getElementById('prohibited-check').checked) {
      showAlert('error', 'You must confirm the gift is not from a prohibited source.');
      return;
    }
    
    // Show success message
    showAlert('success', 'Gift declaration submitted successfully! Forwarded to GDA for HoA review per Rule 21(b).');
    
    // Reset form
    e.target.reset();
    uploadedFiles = [];
    document.getElementById('file-preview-container').innerHTML = '';
    
    // Set default date to today
    const today = new Date().toISOString().split('T')[0];
    document.getElementById('gift-date').value = today;
    
    // Update dashboard count
    const currentCount = parseInt(document.getElementById('gac-personal-declarations').textContent);
    document.getElementById('gac-personal-declarations').textContent = currentCount + 1;
    
    // Navigate to my gifts
    setTimeout(() => navigateTo('my-gifts'), 2000);
  }

  // Handle File Selection
  function handleFileSelect(e) {
    const files = Array.from(e.target.files);
    const previewContainer = document.getElementById('file-preview-container');
    
    files.forEach(file => {
      if (!file.type.startsWith('image/')) {
        showAlert('error', 'Only image files are allowed.');
        return;
      }
      
      if (file.size > 5 * 1024 * 1024) { // 5MB limit
        showAlert('error', 'File size must be less than 5MB.');
        return;
      }
      
      uploadedFiles.push(file);
      
      const reader = new FileReader();
      reader.onload = function(e) {
        const previewItem = document.createElement('div');
        previewItem.className = 'file-preview-item';
        previewItem.innerHTML = `
          <img src="${e.target.result}" alt="${file.name}">
          <button type="button" class="remove-file" onclick="removeFile('${file.name}')">&times;</button>
        `;
        previewContainer.appendChild(previewItem);
      };
      reader.readAsDataURL(file);
    });
  }

  // Remove File
  function removeFile(fileName) {
    uploadedFiles = uploadedFiles.filter(file => file.name !== fileName);
    const previewContainer = document.getElementById('file-preview-container');
    previewContainer.innerHTML = '';
    uploadedFiles.forEach(file => {
      const reader = new FileReader();
      reader.onload = function(e) {
        const previewItem = document.createElement('div');
        previewItem.className = 'file-preview-item';
        previewItem.innerHTML = `
          <img src="${e.target.result}" alt="${file.name}">
          <button type="button" class="remove-file" onclick="removeFile('${file.name}')">&times;</button>
        `;
        previewContainer.appendChild(previewItem);
      };
      reader.readAsDataURL(file);
    });
  }

  // Show Alert
  function showAlert(type, message) {
    const container = document.getElementById('alert-container') || document.body;
    const alert = document.createElement('div');
    alert.className = `alert alert-${type}`;
    alert.innerHTML = `
      <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'warning' ? 'exclamation-triangle' : type === 'error' ? 'times-circle' : 'info-circle'}"></i>
      <span>${message}</span>
    `;
    
    if (container.id === 'alert-container') {
      container.appendChild(alert);
    } else {
      // Create a temporary container at the top
      alert.style.position = 'fixed';
      alert.style.top = '20px';
      alert.style.left = '50%';
      alert.style.transform = 'translateX(-50%)';
      alert.style.zIndex = '10000';
      alert.style.minWidth = '300px';
      document.body.appendChild(alert);
    }
    
    setTimeout(() => alert.remove(), 5000);
  }

  // Modal Functions
  function showModal(title, content, footer = '') {
    document.getElementById('modal-title').textContent = title;
    document.getElementById('modal-body').innerHTML = content;
    document.getElementById('modal-footer').innerHTML = footer;
    document.getElementById('modal-container').classList.add('active');
    currentModal = { title, content, footer };
  }

  function closeModal() {
    document.getElementById('modal-container').classList.remove('active');
    currentModal = null;
  }

  // View Gift Details
  function viewGiftDetails(refNo) {
    const giftData = {
      'GDMS-2025-1011': {
        description: 'Wooden desk organizer received during conference',
        value: 'Nu. 2,800',
        date: '2025-12-23',
        source: 'Conference organizer',
        status: 'Pending HoA Decision',
        notes: 'Gift forwarded to GDA for HoA review. Awaiting decision.',
        path: 'GAC Member ‚Üí GDA ‚Üí HoA (Pending)'
      },
      'GDMS-2025-0815': {
        description: 'Coffee table book from colleague',
        value: 'Nu. 1,200',
        date: '2025-10-30',
        source: 'Colleague (non-prohibited)',
        status: 'HoA Approved',
        notes: 'Approved for retention by HoA. Determined to be nominal value gift.',
        path: 'GAC Member ‚Üí GDA ‚Üí HoA ‚Üí Approved'
      },
      'GDMS-2025-0995': {
        description: 'Hotel accommodation during conference',
        value: 'Nu. 18,000',
        date: '2025-12-15',
        source: 'Conference host',
        status: 'Forwarded to HoA',
        notes: 'Gift forwarded to HoA for decision. Under review.',
        path: 'GAC Member ‚Üí GDA ‚Üí HoA (Under Review)'
      }
    };
    
    const gift = giftData[refNo] || {
      description: 'Gift details not found',
      value: 'N/A',
      date: 'N/A',
      source: 'N/A',
      status: 'Unknown',
      notes: 'No additional information available.',
      path: 'Unknown'
    };
    
    const content = `
      <div class="space-y-4">
        <div class="grid grid-cols-2 gap-4">
          <div>
            <label class="form-label">Reference Number</label>
            <div class="font-bold">${refNo}</div>
          </div>
          <div>
            <label class="form-label">Date Declared</label>
            <div>${gift.date}</div>
          </div>
          <div>
            <label class="form-label">Description</label>
            <div>${gift.description}</div>
          </div>
          <div>
            <label class="form-label">Value</label>
            <div>${gift.value}</div>
          </div>
          <div>
            <label class="form-label">Source/Donor</label>
            <div>${gift.source}</div>
          </div>
          <div>
            <label class="form-label">Status</label>
            <div>${gift.status}</div>
          </div>
          <div class="col-span-2">
            <label class="form-label">Review Path</label>
            <div class="text-purple-600 font-medium">${gift.path}</div>
          </div>
        </div>
        <div>
          <label class="form-label">Notes</label>
          <div class="bg-gray-50 p-3 rounded">${gift.notes}</div>
        </div>
      </div>
    `;
    
    showModal(`Gift Details: ${refNo}`, content, `
      <button class="btn btn-secondary" onclick="closeModal()">Close</button>
    `);
  }

  // Review HoA Gift
  function reviewHoAGift(refNo) {
    const giftData = {
      'GDMS-2025-0998': {
        declarant: 'Pema Lhamo (HoA)',
        description: 'Gold pendant from family member',
        relationship: 'Family member (sibling)',
        value: '22,500',
        gdaComments: 'Family gift. Assess proportionality and whether it creates appearance of conflict.',
        rule: 'Rule 12(3) - Proportionality Test'
      },
      'GDMS-2025-1009': {
        declarant: 'Pema Lhamo (HoA)',
        description: 'Laptop bag received during conference',
        relationship: 'Conference organizer',
        value: '4,200',
        gdaComments: 'Conference souvenir, nominal value. Likely permissible.',
        rule: 'Rule 12(1) - Nominal Value Exception'
      },
      'GDMS-2025-1010': {
        declarant: 'Pema Lhamo (HoA)',
        description: 'Traditional kira from elder',
        relationship: 'Community elder',
        value: '6,800',
        gdaComments: 'Cultural gift from elder. Assess propriety and cultural context.',
        rule: 'Rule 12(4) - Cultural Gifts'
      }
    };
    
    const gift = giftData[refNo] || {
      declarant: 'Unknown',
      description: 'No description',
      relationship: 'Unknown',
      value: 'N/A',
      gdaComments: 'No comments available',
      rule: 'N/A'
    };
    
    const content = `
      <div class="space-y-4">
        <div class="bg-purple-50 p-4 rounded">
          <h4 class="font-bold text-purple-900">${refNo}</h4>
          <p class="text-purple-800">Declarant: ${gift.declarant}</p>
          <p class="text-purple-800">Description: ${gift.description}</p>
          <p class="text-purple-800">Relationship: ${gift.relationship}</p>
          <p class="text-purple-800">Value: Nu. ${gift.value}</p>
        </div>
        <div class="bg-blue-50 p-3 rounded">
          <p class="text-blue-800"><strong>GDA Comments:</strong> ${gift.gdaComments}</p>
          <p class="text-blue-800 mt-1"><strong>Relevant Rule:</strong> ${gift.rule}</p>
        </div>
        <div>
          <label class="form-label">Your Decision</label>
          <select class="form-control" id="gac-decision-${refNo}">
            <option value="">Select decision</option>
            <option value="approve">Approve Retention</option>
            <option value="approve-conditions">Approve with Conditions</option>
            <option value="return">Return to Donor</option>
            <option value="forfeit">Forfeit to State Treasury</option>
            <option value="abstain">Abstain (Conflict of Interest)</option>
          </select>
        </div>
        <div>
          <label class="form-label">Comments (Required)</label>
          <textarea class="form-control" id="gac-comments-${refNo}" rows="3" placeholder="Provide your reasoning for the decision..."></textarea>
        </div>
        <div>
          <label class="form-label">Rule Citation</label>
          <input type="text" class="form-control" id="gac-rule-${refNo}" placeholder="e.g., Rule 12(3)" value="${gift.rule}">
        </div>
        <div class="bg-yellow-50 p-3 rounded text-sm">
          <i class="fas fa-info-circle text-yellow-600 mr-2"></i>
          Your vote will be recorded. HoA must recuse from discussion of their own gift. Majority decision required.
        </div>
      </div>
    `;
    
    const footer = `
      <button class="btn btn-secondary" onclick="closeModal()">Cancel</button>
      <button class="btn btn-primary" onclick="submitGACVote('${refNo}')">Submit Vote</button>
    `;
    
    showModal(`GAC Review: ${refNo}`, content, footer);
  }

  function submitGACVote(refNo) {
    const decision = document.getElementById(`gac-decision-${refNo}`).value;
    const comments = document.getElementById(`gac-comments-${refNo}`).value;
    
    if (!decision) {
      showAlert('error', 'Please select a decision.');
      return;
    }
    
    if (!comments.trim()) {
      showAlert('error', 'Please provide comments explaining your decision.');
      return;
    }
    
    showAlert('success', `Your vote for ${refNo} has been recorded.`);
    closeModal();
    
    // Update table status
    const rows = document.querySelectorAll('#gac-review-table tr');
    rows.forEach(row => {
      if (row.textContent.includes(refNo)) {
        const voteCell = row.querySelector('td:nth-child(6)');
        if (voteCell) {
          let statusText = '';
          let statusClass = '';
          
          switch(decision) {
            case 'approve':
              statusText = 'Approve';
              statusClass = 'status-approved';
              break;
            case 'approve-conditions':
              statusText = 'Approve with Conditions';
              statusClass = 'status-approved';
              break;
            case 'return':
              statusText = 'Return';
              statusClass = 'status-returned';
              break;
            case 'forfeit':
              statusText = 'Forfeit';
              statusClass = 'status-returned';
              break;
            case 'abstain':
              statusText = 'Abstained';
              statusClass = 'status-waiting';
              break;
          }
          
          voteCell.innerHTML = `<span class="status-badge ${statusClass}">${statusText}</span>`;
        }
      }
    });
    
    // Update pending count
    const current = parseInt(document.getElementById('gac-pending-review').textContent);
    if (current > 0) {
      document.getElementById('gac-pending-review').textContent = current - 1;
    }
    
    // Update agenda count
    const agendaCount = parseInt(document.getElementById('agenda-count').textContent);
    if (agendaCount > 0) {
      document.getElementById('agenda-count').textContent = agendaCount - 1;
    }
  }

  // Schedule GAC Meeting
  function scheduleGACMeeting() {
    const content = `
      <div class="space-y-4">
        <div class="bg-purple-50 p-4 rounded">
          <h4 class="font-bold text-purple-900"><i class="fas fa-calendar-alt mr-2"></i> Schedule GAC Meeting</h4>
          <p class="text-purple-800">GDA convenes GAC meetings for HoA gift reviews per Rule 21a.</p>
        </div>
        <div>
          <label class="form-label">Meeting Date</label>
          <input type="date" class="form-control" id="gac-meeting-date" value="${new Date().toISOString().split('T')[0]}">
        </div>
        <div>
          <label class="form-label">Time</label>
          <input type="time" class="form-control" id="gac-meeting-time" value="14:30">
        </div>
        <div>
          <label class="form-label">Venue</label>
          <input type="text" class="form-control" id="gac-meeting-venue" value="ACC Conference Room">
        </div>
        <div>
          <label class="form-label">Agenda</label>
          <textarea class="form-control" id="gac-meeting-agenda" rows="3">Review of HoA gift declarations pending GAC review</textarea>
        </div>
        <div class="bg-yellow-50 p-3 rounded text-sm">
          <i class="fas fa-info-circle text-yellow-600 mr-2"></i>
          Note: GDA typically convenes GAC meetings. This request will be sent to GDA for scheduling.
        </div>
      </div>
    `;
    
    const footer = `
      <button class="btn btn-secondary" onclick="closeModal()">Cancel</button>
      <button class="btn btn-primary" onclick="requestGACMeeting()">Request Meeting</button>
    `;
    
    showModal('Schedule GAC Meeting', content, footer);
  }

  function requestGACMeeting() {
    const date = document.getElementById('gac-meeting-date').value;
    const time = document.getElementById('gac-meeting-time').value;
    
    showAlert('success', `GAC meeting request sent to GDA for ${date} at ${time}. GDA will confirm and notify members.`);
    closeModal();
  }

  // Join Meeting
  function joinMeeting() {
    showAlert('info', 'Joining GAC meeting... Meeting link will be provided by GDA.');
  }

  // View Agenda
  function viewAgenda() {
    const content = `
      <div class="space-y-4">
        <div class="bg-purple-50 p-4 rounded">
          <h4 class="font-bold text-purple-900">GAC Meeting Agenda</h4>
          <p class="text-purple-800">Date: 28 December 2025 ‚Ä¢ Time: 2:30 PM ‚Ä¢ Venue: ACC Conference Room</p>
        </div>
        <div>
          <h5 class="font-bold text-gray-900 mb-2">Agenda Items</h5>
          <ol class="list-decimal pl-5 space-y-2">
            <li class="text-gray-700">Welcome and confirmation of quorum</li>
            <li class="text-gray-700">Review of HoA gift: GDMS-2025-0998 (Gold pendant)</li>
            <li class="text-gray-700">Review of HoA gift: GDMS-2025-1009 (Laptop bag)</li>
            <li class="text-gray-700">Review of HoA gift: GDMS-2025-1010 (Traditional kira)</li>
            <li class="text-gray-700">Voting and decision recording</li>
            <li class="text-gray-700">Any other business</li>
            <li class="text-gray-700">Next meeting date</li>
          </ol>
        </div>
        <div class="bg-blue-50 p-3 rounded">
          <h5 class="font-bold text-blue-900 mb-1">Required Preparation</h5>
          <p class="text-blue-800 text-sm">‚Ä¢ Review all gift documentation before meeting<br>‚Ä¢ Prepare questions for clarification<br>‚Ä¢ Consider proportionality and propriety tests</p>
        </div>
      </div>
    `;
    
    showModal('GAC Meeting Agenda', content, `
      <button class="btn btn-secondary" onclick="closeModal()">Close</button>
      <button class="btn btn-primary" onclick="downloadAgenda()">
        <i class="fas fa-download mr-2"></i> Download Agenda
      </button>
    `);
  }

  function downloadAgenda() {
    showAlert('success', 'Meeting agenda downloaded successfully.');
    closeModal();
  }

  // View Minutes
  function viewMinutes(refNo) {
    const minutesData = {
      'GAC-MIN-2025-008': {
        date: '28 December 2025',
        chairperson: 'Sonam Choden',
        members: 'Sonam Choden, Dorji Wangmo, Karma Dorji',
        gifts: 'GDMS-2025-0998, GDMS-2025-1009, GDMS-2025-1010',
        decisions: '2 Approved, 1 Returned',
        notes: 'Meeting to review HoA gift declarations. Quorum confirmed.',
        status: 'Draft'
      },
      'GAC-MIN-2025-007': {
        date: '15 December 2025',
        chairperson: 'Sonam Choden',
        members: 'Sonam Choden, Dorji Wangmo, Karma Dorji',
        gifts: 'GDMS-2025-0702, GDMS-2025-0651',
        decisions: '1 Approved, 1 Forfeited',
        notes: 'Regular quarterly GAC meeting. Decisions communicated to HoA.',
        status: 'Approved'
      }
    };
    
    const minutes = minutesData[refNo] || {
      date: 'N/A',
      chairperson: 'N/A',
      members: 'N/A',
      gifts: 'N/A',
      decisions: 'N/A',
      notes: 'No minutes available',
      status: 'Unknown'
    };
    
    const content = `
      <div class="space-y-4">
        <div class="bg-purple-50 p-4 rounded">
          <h4 class="font-bold text-purple-900">${refNo}</h4>
          <p class="text-purple-800">Meeting Date: ${minutes.date}</p>
          <p class="text-purple-800">Status: ${minutes.status}</p>
        </div>
        <div class="grid grid-cols-2 gap-4">
          <div>
            <label class="form-label">Chairperson</label>
            <div>${minutes.chairperson}</div>
          </div>
          <div>
            <label class="form-label">Members Present</label>
            <div>${minutes.members}</div>
          </div>
          <div>
            <label class="form-label">Gifts Reviewed</label>
            <div>${minutes.gifts}</div>
          </div>
          <div>
            <label class="form-label">Decisions</label>
            <div>${minutes.decisions}</div>
          </div>
        </div>
        <div>
          <label class="form-label">Meeting Notes</label>
          <div class="bg-gray-50 p-3 rounded">${minutes.notes}</div>
        </div>
      </div>
    `;
    
    showModal(`Meeting Minutes: ${refNo}`, content, `
      <button class="btn btn-secondary" onclick="closeModal()">Close</button>
      <button class="btn btn-primary" onclick="downloadMinutes('${refNo}')">
        <i class="fas fa-download mr-2"></i> Download PDF
      </button>
    `);
  }

  function downloadMinutes(refNo) {
    showAlert('success', `${refNo} downloaded successfully.`);
    closeModal();
  }

  // Create Minutes
  function createMinutes() {
    showAlert('info', 'Minutes creation feature will be available after the meeting.');
  }

  // Export Minutes
  function exportMinutes() {
    showAlert('success', 'All minutes exported successfully.');
  }

  // Download Resource
  function downloadResource(type) {
    const resources = {
      rules: 'Gift_Rules_2022.pdf',
      templates: 'GAC_Templates.zip',
      faqs: 'GDMS_FAQs.pdf'
    };
    
    showAlert('success', `Downloading ${resources[type]}...`);
  }

  // Show GAC Workflow
  function showGACWorkflow() {
    const content = `
      <div class="space-y-4">
        <div>
          <h4 class="font-bold text-gray-900 mb-2">GAC Workflow Summary</h4>
          <p class="text-gray-600">As Gift Administration Committee member, your responsibilities are:</p>
        </div>
        <div class="bg-purple-50 p-4 rounded">
          <h5 class="font-bold text-purple-900 mb-2">1. Review HoA Gifts Only</h5>
          <p class="text-purple-800">‚Ä¢ GDA convenes GAC for HoA gifts (Rule 21a)<br>‚Ä¢ HoA must recuse from own gift review<br>‚Ä¢ Review within 14 days of declaration</p>
        </div>
        <div class="bg-blue-50 p-4 rounded">
          <h5 class="font-bold text-blue-900 mb-2">2. Committee Deliberation</h5>
          <p class="text-blue-800">‚Ä¢ Quorum: 3 members minimum<br>‚Ä¢ Decisions by majority vote<br>‚Ä¢ Document dissenting views<br>‚Ä¢ Apply proportionality and propriety tests</p>
        </div>
        <div class="bg-green-50 p-4 rounded">
          <h5 class="font-bold text-green-900 mb-2">3. Decision Implementation</h5>
          <p class="text-green-800">‚Ä¢ Record decisions in minutes<br>‚Ä¢ Communicate to HoA within 2 days<br>‚Ä¢ GDA implements decisions<br>‚Ä¢ Update Gift Register</p>
        </div>
        <div class="bg-yellow-50 p-4 rounded">
          <h5 class="font-bold text-yellow-900 mb-2">4. Your Personal Gifts</h5>
          <p class="text-yellow-800">‚Ä¢ Your gifts ‚Üí GDA ‚Üí HoA decides (Rule 21b)<br>‚Ä¢ You cannot review own gifts<br>‚Ä¢ Separate from GAC duties</p>
        </div>
      </div>
    `;
    
    showModal('GAC Workflow Guide', content, `
      <button class="btn btn-secondary" onclick="closeModal()">Close</button>
    `);
  }

  // Show FAQs
  function showFAQs() {
    const content = `
      <div class="space-y-4">
        <div>
          <h4 class="font-bold text-gray-900 mb-2">Q: What gifts does GAC review?</h4>
          <p class="text-gray-600">GAC reviews <strong>HoA gifts only</strong> per Rule 21a. GAC member and GDA gifts are reviewed by HoA.</p>
        </div>
        <div>
          <h4 class="font-bold text-gray-900 mb-2">Q: Can I review my own gifts as GAC member?</h4>
          <p class="text-gray-600">No. Your gifts go to GDA ‚Üí HoA for decision. You cannot participate in review of your own gifts (conflict of interest).</p>
        </div>
        <div>
          <h4 class="font-bold text-gray-900 mb-2">Q: Who convenes GAC meetings?</h4>
          <p class="text-gray-600">GDA convenes GAC meetings within 14 days of HoA gift declaration. GDA sets agenda and notifies members.</p>
        </div>
        <div>
          <h4 class="font-bold text-gray-900 mb-2">Q: What voting rules apply?</h4>
          <p class="text-gray-600">Simple majority of members present. Minimum 3 members for quorum. HoA cannot vote on own gifts.</p>
        </div>
      </div>
    `;
    
    showModal('Frequently Asked Questions', content, `
      <button class="btn btn-secondary" onclick="closeModal()">Close</button>
      <button class="btn btn-primary" onclick="downloadResource('faqs')">
        <i class="fas fa-download mr-2"></i> Download Full FAQs
      </button>
    `);
  }

  // Show Rule Details
  function showRuleDetails(rule) {
    const rules = {
      'Rule 21a': {
        title: 'Review by Gift Administration Committee',
        content: 'All gifts received by the Head of Agency shall be reviewed by the Gift Administration Committee.',
        requirements: [
          'GDA convenes GAC within 14 days',
          'HoA must recuse from discussion',
          'Minimum 3 members for quorum',
          'Decisions by majority vote',
          'Minutes must be recorded'
        ]
      },
      'Rule 21b': {
        title: 'Review of GDA and GAC Member Gifts',
        content: 'Gifts received by GDA and GAC members shall be reviewed by the Head of Agency.',
        requirements: [
          'GDA/GAC gifts ‚Üí HoA decides',
          'Cannot be reviewed by GAC',
          'HoA makes independent decision',
          'Documented in Gift Register'
        ]
      },
      'Rule 19': {
        title: 'Constitution of Gift Administration Committee',
        content: 'Head of Agency shall constitute a Gift Administration Committee with minimum 3 members.',
        requirements: [
          'HoA appoints all members',
          'Minimum 3 senior officers',
          'Serve 2-year term',
          'Appointments in writing',
          'Notified to ACC'
        ]
      }
    };
    
    const ruleData = rules[rule];
    const content = `
      <div class="space-y-4">
        <div class="bg-purple-50 p-4 rounded">
          <h4 class="font-bold text-purple-900 mb-2">${rule}: ${ruleData.title}</h4>
          <p class="text-purple-800">${ruleData.content}</p>
        </div>
        <div>
          <h5 class="font-bold text-gray-900 mb-2">Requirements:</h5>
          <ul class="list-disc pl-5 space-y-1">
            ${ruleData.requirements.map(req => `<li class="text-gray-600">${req}</li>`).join('')}
          </ul>
        </div>
      </div>
    `;
    
    showModal(`Rule Details: ${rule}`, content, `
      <button class="btn btn-secondary" onclick="closeModal()">Close</button>
    `);
  }

  // Logout Function
  function logout() {
    if (confirm('Are you sure you want to logout?')) {
      // Clear authentication data
      localStorage.removeItem('gdms_user');
      localStorage.removeItem('gdms_token');
      sessionStorage.removeItem('gdms_session');
      
      // Redirect to login
      window.location.href = 'login.html';
    }
  }

  // Simulate Connection Status
  setInterval(() => {
    const status = document.getElementById('connection-status');
    if (Math.random() > 0.1) {
      status.innerHTML = '<i class="fas fa-wifi"></i><span>Online</span>';
      status.style.background = '#d4edda';
      status.style.color = '#155724';
      status.style.borderColor = '#c3e6cb';
    } else {
      status.innerHTML = '<i class="fas fa-exclamation-triangle"></i><span>Connection Issues</span>';
      status.style.background = '#fff3cd';
      status.style.color = '#856404';
      status.style.borderColor = '#ffeaa7';
    }
  }, 10000);
  </script>
</body>
</html>